(global.webpackChunk_N_E=global.webpackChunk_N_E||[]).push([[405],{9536:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5196)}])},5196:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>je});var r=n(3842),s=n(2050),a=n(3444),i=n(9312),l=n(4246);const o=require("electron");var c=n(7378),d=n(4157),u=n(2186),m=n(7668);function p(e){var t=e.prevCallback,n=e.nextCallback;return(0,l.jsxs)("div",{className:"flex items-center rounded-md shadow-sm",children:[(0,l.jsxs)("button",{type:"button",className:"flex items-center justify-center py-2 pl-3 pr-4 text-gray-400 bg-white border border-r-0 border-gray-300 rounded-l-md hover:text-gray-500 md:w-9 md:px-2 md:hover:bg-gray-50",onClick:t,children:[(0,l.jsx)("span",{className:"sr-only",children:"Previous day"}),(0,l.jsx)(u.Z,{className:"w-5 h-5","aria-hidden":"true"})]}),(0,l.jsx)("span",{className:"relative w-px h-5 -mx-px bg-gray-300"}),(0,l.jsxs)("button",{type:"button",className:"flex items-center justify-center py-2 pl-4 pr-3 text-gray-400 bg-white border border-l-0 border-gray-300 rounded-r-md hover:text-gray-500 md:w-9 md:px-2 md:hover:bg-gray-50",onClick:n,children:[(0,l.jsx)("span",{className:"sr-only",children:"Next day"}),(0,l.jsx)(m.Z,{className:"w-5 h-5","aria-hidden":"true"})]})]})}var x=864e5;function h(e){var t=e.selectedDate,n=e.setSelectedDate,r=new Date;return(0,l.jsxs)("div",{className:"flex items-center justify-between px-4 py-5 sm:px-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-lg flex items-center font-semibold leading-6 text-gray-900",children:[(0,l.jsx)("time",{dateTime:"2022-01-22",className:"sm:hidden",children:f(t,"short")}),(0,l.jsx)("time",{dateTime:"2022-01-22",className:"hidden sm:inline",children:f(t,"long")}),t.toLocaleDateString()===r.toLocaleDateString()&&(0,l.jsx)("span",{className:"inline-flex px-2.5 py-0.5 ml-3 rounded-full text-xs font-medium bg-blue-300 text-white",children:"Today"})]}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:null===t||void 0===t?void 0:t.toLocaleDateString("en-US",{weekday:"long"})})]}),(0,l.jsx)(p,{prevCallback:function(){n((function(e){return new Date(e.getTime()-x)}))},nextCallback:function(){n((function(e){return new Date(e.getTime()+x)}))}})]})}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"long";return e.toLocaleDateString("en-US",{month:t,day:"numeric",year:"numeric"})}var v=n(4165);function g(e){var t=e.folderLocation,n=e.setFolderLocation;return(0,l.jsxs)("button",{className:"min-w-0 py-2 px-3 w-[22em] shadow-sm text-gray-500 focus-visible:outline-blue-500 sm:text-sm border border-gray-300 rounded-md flex justify-between items-center gap-4 cursor-pointer",title:t,onClick:function(){o.ipcRenderer.invoke("app:select-folder").then((function(e){e&&n(e)}))},children:[(0,l.jsx)("span",{className:"flex-shrink overflow-hidden text-ellipsis whitespace-nowrap",children:t||"Select a folder"}),(0,l.jsx)(v.Z,{className:"w-4 h-4","aria-hidden":"true"})]})}var b=n(6805),y=n(7467),j={getItem:function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,o.ipcRenderer.invoke("storage:get",e)];case 1:return[2,t.sent()||null]}}))}));return function(t){return e.apply(this,arguments)}}(),setItem:function(){var e=(0,r.Z)((function(e,t){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,o.ipcRenderer.invoke("storage:set",e,t)];case 1:return n.sent(),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),removeItem:function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,o.ipcRenderer.invoke("storage:delete",e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}()},w=(0,b.Ue)()((0,y.mW)((0,y.tJ)((function(e){return{reportsFolder:null,setReportsFolder:function(t){return e({reportsFolder:t})}}}),{name:"main-storage",storage:(0,y.FL)((function(){return j}))})));function N(){var e=(0,s.Z)(w((function(e){return[e.reportsFolder,e.setReportsFolder]}),d.X),2),t=e[0],n=e[1];return(0,l.jsx)("header",{className:"bg-white shadow",children:(0,l.jsx)("div",{className:"flex justify-between h-16 px-2 mx-auto max-w-[1400px] sm:px-4 lg:px-8",children:(0,l.jsx)("div",{className:"flex w-full justify-end items-center flex-shrink min-w-0 gap-4",children:(0,l.jsx)(g,{folderLocation:t,setFolderLocation:n})})})})}function k(e){if(!e)return[];var t=0,n="",r=/^[0-9]+:[0-9]+/,s=/^[0-9]+/,a=/[0-9]+$/,i=/^\s*[0-9]{4}-[0-9]{2}-[0-9]{2}\s*/,l=/^[\s]*-[\s]*/,o=/^![\w]*/,c=/^[\w+\s*\w*\.]+/,d=e.split("\n"),u=[],m=[u,n],p=!0,x=!1,h=void 0;try{for(var f,v=d[Symbol.iterator]();!(p=(f=v.next()).done);p=!0){var g=f.value;if(r.test(g.slice(0,8))){var b={id:t,from:"",project:"",activity:"",description:"",isBreak:!1,isValid:!0,mistakes:""},y=g.match(r),j=parseInt(y[0].match(s)[0]),w=parseInt(y[0].match(a)[0]),N=new Date;N.setHours(j),N.setMinutes(w),b.from=r.exec(g)[0],t>0&&(u[t-1].to=b.from,u[t-1].duration=S(u[t-1].from,u[t-1].to));var k=g.replace(r,"");if(i.test(k)){var C=k.match(i)[0];k=k.replace(C,"")}k=k.replace(l,"");var D=o.test(k)||!k;if(D)b.project=k,b.isBreak=D,u.push(b),t++;else{var Z=k.match(c)?k.match(c)[0]:"";if(Z){b.project=Z.trim().toLowerCase();var I=k.indexOf(Z);k=(k=I<0?k:k.slice(0,I)+k.slice(I+Z.length)).replace(l,"")}var M=N>new Date(2016,7,23)?/(.+?)\s-\s+/:/(.+?)-\s*/,E=new RegExp(M);if(E.test(k)){var F=k.match(E)[1];b.activity=N>new Date(2016,7,26)?F.trim():F.trim().toLowerCase(),k=k.replace(E,"")}b.description=k.replace(/\ufffd/g,"-"),u.push(b),t++}}else n+=g+"\n"}}catch(R){x=!0,h=R}finally{try{p||null==v.return||v.return()}finally{if(x)throw h}}return m[1]=n.trimEnd(),m}function S(e,t){if(void 0==e||void 0==t)return null;var n=e.split(":"),r=t.split(":"),s=parseInt(n[0],10)||0,a=parseInt(n[1],10)||0;return 60*(60*(parseInt(r[0],10)||0)+(parseInt(r[1],10)||0)-(60*s+a))*1e3}function C(e){if(void 0!=e){var t=e/1e3/60/60;if(Math.abs(t)<1){var n=Math.round(e/1e3/60);return"".concat(n,"m")}return"".concat(Math.floor(100*t)/100,"h")}}function D(e,t){var n=(0,s.Z)(e.split(":"),2),r=n[0],a=n[1],i=(0,s.Z)(t.split(":"),2),l=i[0],o=i[1],c=60*Number(r)+Number(a);return 60*Number(l)+Number(o)<c}function Z(e){for(var t=0;t<e.length;t++)t>0&&D(e[t-1].to,e[t].from)&&(e[t-1].isValid=!1),(e[t].duration<=0||e[t].project&&!e[t].to)&&(e[t].isValid=!1),e[t].description.startsWith("!")&&(e[t].mistakes+=" startsWith!"),t>0&&e[t].to&&!e[t].project&&(e[t].isValid=!1);return e}function I(e){var t=(0,s.Z)(e.split(":"),2),n=t[0],r=t[1];return 60*Number(n)+Number(r)}var M=n(8944),E=n(335),F=n(1924),R=n(3322);const _=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,c.useState)(e),n=t[0],r=t[1],a=function(e){var t=e.target.value.replace(/[^0-9:]/g,"");if(!(t.split(":").length>2)&&!(t.length>5)&&!(t.length>2&&":"!==t[2])){if(1===n.length&&2===t.length&&":"!==t.slice(-1)&&(t+=":"),n.length-t.length===1&&":"===n.slice(-1)&&":"!==t.slice(-1)&&(t=t.substring(0,t.length-1)),":"===t[0]&&(t="0"+t),t.includes(":")){var a=(0,s.Z)(t.split(":"),2),i=a[0],l=a[1],o=i&&parseInt(i)>23?"23":i,c=l&&parseInt(l)>59?"59":l;t="".concat(o,":").concat(c)}r(t)}},i=function(){var e=(0,s.Z)(n.split(":"),2),t=e[0],a=e[1];t&&r("".concat(t.padStart(2,"0"),":").concat((a||"").padStart(2,"0")))};return[n,a,i,r]};function L(e){var t=new Date,n=new Date(e);return t.setHours(0,0,0,0)===n.setHours(0,0,0,0)}function T(e){var t=function(e){var t=parseInt(e.slice(0,4),10),n=parseInt(e.slice(4,6),10)-1,r=parseInt(e.slice(6,8),10);return new Date(t,n,r)}(e),n=new Date(t.getFullYear(),0,1),r=Math.floor((t.getTime()-n.getTime())/864e5);return Math.ceil((r+n.getDay()+1)/7)}function A(){var e=new Date,t=e.getHours(),n=e.getMinutes(),r=Math.ceil(n/15>3?t+1:t).toString().padStart(2,"0"),s=(15*Math.ceil(n/15>3?0:n/15)).toString().padStart(2,"0");return"".concat(r,":").concat(s)}var B=n(5463),O=n(2008),P=n(701);function H(e){var t=e.title,n=e.className,r=void 0===n?"":n,s=e.selectedItem,a=e.availableItems,i=e.setSelectedItem,o=e.required,c=void 0!==o&&o,d=e.tabIndex,u=e.isValidationEnabled,m=e.isLastThree,p=""===s?null===a||void 0===a?void 0:a.filter((function(e,t){return m?""!==e&&t<3:""!==e})):null===a||void 0===a?void 0:a.filter((function(e){return e.toLowerCase().includes(s.toLowerCase())})).sort();return(0,l.jsxs)(P.h,{className:r,as:"div",value:s,onChange:i,children:[(0,l.jsx)(P.h.Label,{className:"block text-sm font-medium text-gray-700",children:t}),(0,l.jsxs)("div",{className:"relative mt-1",children:[(0,l.jsx)(P.h.Input,{required:c,spellCheck:!1,className:(0,M.Z)("w-full py-2 pl-3 pr-10 bg-white border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 sm:text-sm",{"border-red-300 text-red-900 placeholder-red-300":c&&u&&!s}),onChange:function(e){return i(e.target.value)},tabIndex:d}),(0,l.jsx)(P.h.Button,{className:"absolute inset-y-0 right-0 flex items-center px-2 rounded-r-md focus:outline-none",children:(0,l.jsx)(B.Z,{className:"w-5 h-5 text-gray-400","aria-hidden":"true"})}),(null===p||void 0===p?void 0:p.length)>0?(0,l.jsxs)(P.h.Options,{className:"absolute z-10 w-full py-1 mt-1 overflow-auto text-base bg-white rounded-md shadow-lg max-h-40 ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:[(0,l.jsx)("div",{className:"block text-xs text-gray-500 text-center",children:"tab to choose"}),null===p||void 0===p?void 0:p.map((function(e,t){return(0,l.jsx)(P.h.Option,{value:e,className:function(e){var t=e.active;return(0,M.Z)("relative cursor-default select-none py-2 pl-3 pr-9",t?"bg-blue-600 text-white":"text-gray-900")},children:function(t){var n=t.active,r=t.selected;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:(0,M.Z)("block truncate",r&&"font-semibold"),children:e}),r&&(0,l.jsx)("span",{className:(0,M.Z)("absolute inset-y-0 right-0 flex items-center pr-4",n?"text-white":"text-blue-600"),children:(0,l.jsx)(O.Z,{className:"w-5 h-5","aria-hidden":"true"})})]})}},t)}))]}):(0,l.jsx)(P.h.Options,{className:"absolute z-10 w-full py-1 mt-1 overflow-auto text-base bg-white rounded-md shadow-lg max-h-40 ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:(0,l.jsx)(P.h.Option,{value:s,className:function(e){var t=e.active;return(0,M.Z)("relative cursor-default select-none py-2 pl-3 pr-9",t?"bg-blue-600 text-white":"text-gray-900")},children:function(e){var t=e.active,n=e.selected;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:(0,M.Z)("block truncate",n&&"font-semibold"),children:s}),n&&(0,l.jsx)("span",{className:(0,M.Z)("absolute inset-y-0 right-0 flex items-center pr-4",t?"text-white":"text-blue-600"),children:(0,l.jsx)(O.Z,{className:"w-5 h-5","aria-hidden":"true"})})]})}},1)})]})]})}function V(){return(0,l.jsxs)("svg",{"aria-hidden":"true",role:"status",className:"inline w-4 h-4 mr-3 text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),(0,l.jsx)("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]})}var W="hover:bg-blue-700 ";function U(e){var t=e.callback,n=e.text,r=e.disabled,s=e.status,a=e.type,i=e.tabIndex,o={enabled:{text:"Save",classes:"bg-blue-600 text-white border-transparent "+W},disabled:{text:"Save",classes:"bg-grey-600 text-white border-transparent "+W},inprogress:{text:"Saving...",classes:"bg-blue-600 text-white border-transparent "+W},done:{text:"Saved",classes:"bg-green-600 text-white border-transparent "+W},cancel:{text:"Cancel",classes:"bg-white text-gray-700 border-gray-300 hover:bg-gray-50 "}},c="inline-flex items-center justify-center px-4 py-2 text-sm font-medium border rounded-md shadow-sm  "+(o[s]?o[s].classes:"bg-blue-600 text-white "+W)+"focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:pointer-events-none disabled:bg-gray-300 ";return(0,l.jsxs)("button",{onClick:t,type:a,className:c,disabled:r||!1,tabIndex:i,children:[s&&"inprogress"===s&&(0,l.jsx)(V,{}),o[s]?o[s].text:n]})}function z(e){var t=e.activities,n=e.isOpen,r=e.editedActivity,a=e.latestProjAndAct,i=e.latestProjAndDesc,o=e.close,d=e.submitActivity,u=e.selectedDate,m=(0,s.Z)(_(),4),p=m[0],x=m[1],h=m[2],f=m[3],v=(0,s.Z)(_(),4),g=v[0],b=v[1],y=v[2],j=v[3],w=(0,c.useState)(""),N=w[0],k=w[1],D=(0,c.useState)(""),Z=D[0],I=D[1],T=(0,c.useState)(""),A=T[0],B=T[1],O=(0,c.useState)(""),P=O[0],V=O[1],W=(0,c.useState)(!1),z=W[0],q=W[1],J=(0,c.useState)(!1),X=J[0],Y=J[1],G=(0,c.useMemo)((function(){return p.includes(":")&&g.includes(":")?S(p,g):null}),[p,g]),K=(0,c.useMemo)((function(){return!p||!g||!G||G<0||!Z}),[p,g,G,Z]);(0,c.useEffect)((function(){r&&"new"!==r?(f(r.from||""),j(r.to||""),k(C(r.duration)||""),I(r.project||""),B(r.activity||""),V(r.description||"")):$()}),[r]),(0,c.useEffect)((function(){if("new"===r){var e=new Date,n=e.getHours().toString().padStart(2,"0"),s=e.getMinutes().toString().padStart(2,"0"),a=(15*Math.floor(Number(s)/15)).toString().padStart(2,"0"),i=Math.ceil(Number(s)/15>3?Number(n)+1:Number(n)),l=(15*Math.ceil(Number(s)/15>3?0:Number(s)/15)).toString().padStart(2,"0"),o=L(u);t.length&&t[t.length-1].to?f(t[t.length-1].to):t.length&&!t[t.length-1].to?f(t[t.length-1].from):f("".concat(n,":").concat(a)),j(o?"".concat(i,":").concat(l):"")}}),[n]),(0,c.useEffect)((function(){!function(e,t,n){for(var r=0;r<e.length;r++){var s;if(!Object.keys(t).length)break;if(e[r].project&&!(null===(s=e[r].project)||void 0===s?void 0:s.startsWith("!"))&&(e[r].description||e[r].activity)){var a,i,l,o,c=e[r].project.trim();if(t.hasOwnProperty(c)&&n.hasOwnProperty(c))e[r].description&&(t[c].includes(e[r].description)?(null===(a=t[c])||void 0===a||a.splice(t[c].indexOf(e[r].description),1),null===(i=t[c])||void 0===i||i.unshift(e[r].description)):t[c].unshift(e[r].description)),e[r].activity&&(n[c].includes(e[r].activity)?(null===(l=n[c])||void 0===l||l.splice(n[c].indexOf(e[r].activity),1),null===(o=n[c])||void 0===o||o.unshift(e[r].activity)):n[c].unshift(e[r].activity));else t[c]=[e[r].description],n[c]=[e[r].activity]}}}(t,i,a)}),[n,i,a]),(0,c.useEffect)((function(){null===G||z||k(C(G))}),[p,g]);var $=function(){f(""),j(""),k(""),I(""),B(""),V(""),Y(!1)},Q=function(e){e.preventDefault()},ee=function(e){e.target.select()};return(0,l.jsx)(E.u.Root,{show:n,as:c.Fragment,children:(0,l.jsx)(F.V,{as:"div",className:"fixed inset-0 z-10 overflow-y-auto",onClose:o,children:(0,l.jsxs)("div",{className:"flex items-end justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,l.jsx)(E.u.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)(F.V.Overlay,{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75"})}),(0,l.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,l.jsx)(E.u.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsxs)("form",{className:"relative inline-block px-4 pt-5 pb-4 text-left align-bottom transition-all transform bg-white rounded-lg shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",onSubmit:function(e){e.preventDefault(),K?Y(!0):(d({id:"new"===r?null:r.id,from:p,to:g,duration:G,project:Z,activity:A,description:P}),o())},children:[(0,l.jsx)("div",{className:"absolute top-0 right-0 hidden pt-4 pr-4 sm:block",children:(0,l.jsxs)("button",{type:"button",className:"text-gray-400 bg-white rounded-md hover:text-gray-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:o,tabIndex:9,children:[(0,l.jsx)("span",{className:"sr-only",children:"Close"}),(0,l.jsx)(R.Z,{className:"w-6 h-6","aria-hidden":"true"})]})}),(0,l.jsxs)("div",{className:"mt-3 space-y-6 text-center sm:mt-0 sm:text-left",children:[(0,l.jsx)(F.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Track time"}),(0,l.jsxs)("div",{className:"grid grid-cols-6 gap-6",children:[(0,l.jsxs)("div",{className:"col-span-6 sm:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"from",className:"block text-sm font-medium text-gray-700",children:"From"}),(0,l.jsx)("input",{required:!0,value:p,onChange:x,onBlur:h,onFocus:ee,type:"text",id:"from",tabIndex:1,className:(0,M.Z)("block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300 text-red-900 placeholder-red-300":X&&!p}),onDragStart:Q})]}),(0,l.jsxs)("div",{className:"col-span-6 sm:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"to",className:"block text-sm font-medium text-gray-700",children:"To"}),(0,l.jsx)("input",{required:!0,value:g,onChange:b,onBlur:y,onFocus:ee,type:"text",id:"to",tabIndex:2,className:(0,M.Z)("block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300 text-red-900 placeholder-red-300":X&&!g}),onDragStart:Q})]}),(0,l.jsxs)("div",{className:"col-span-6 sm:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700",htmlFor:"duration",children:"Duration"}),(0,l.jsx)("input",{onChange:function(e){var t=e.target.value;/^-?(\d*\.?\d*)?[hm]?$|^-?[hm](?![hm.])$/i.test(t)&&(q(!0),k(t),j(function(e,t){var n=(0,s.Z)(e.split(":").map(Number),2),r=60*n[0]+n[1];if(t.includes("m")||parseInt(t)>24){var a=parseInt(t);a&&(r+=a)}else{var i=parseFloat(t);i&&(r+=60*i)}r>=1440?r=1439:r<0&&(r=0);var l=Math.floor(r/60),o=Math.round(r%60),c=String(l).padStart(2,"0"),d=String(o).padStart(2,"0");return"".concat(c,":").concat(d)}(p,t)))},onBlur:function(){q(!1),k(C(G))},onFocus:ee,value:N,type:"text",id:"duration",tabIndex:3,className:(0,M.Z)("block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300 text-red-900 placeholder-red-300":X&&(!G||G<0)}),onDragStart:Q})]}),(0,l.jsx)("div",{className:"col-span-6",children:(0,l.jsx)(H,{title:"Project",required:!0,availableItems:a?Object.keys(a):[],selectedItem:Z,setSelectedItem:I,isValidationEnabled:X,isLastThree:!1,tabIndex:4})}),(0,l.jsx)("div",{className:"col-span-6",children:(0,l.jsx)(H,{title:"Activity",availableItems:a?a[Z]:[],selectedItem:A,setSelectedItem:B,isLastThree:!0,tabIndex:5})}),(0,l.jsx)("div",{className:"col-span-6",children:(0,l.jsx)(H,{title:"Description",availableItems:i?i[Z]:[],selectedItem:P,setSelectedItem:V,isLastThree:!0,tabIndex:6})})]})]}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,l.jsx)(U,{text:"Cancel",type:"button",callback:o,status:"cancel",tabIndex:8}),(0,l.jsx)(U,{text:"Save",type:"submit",status:"enabled",tabIndex:7})]})})]})})]})})})}function q(e){var t=e.selectedDateReport,n=e.onSave,r=(0,c.useState)(""),s=r[0],a=r[1],i=(0,c.useState)("disabled"),o=i[0],d=i[1],u=function(e){"KeyS"===e.code&&e.ctrlKey&&m()};(0,c.useEffect)((function(){return document.addEventListener("keydown",u),function(){document.removeEventListener("keydown",u)}}),[s]),(0,c.useEffect)((function(){p(t)}),[t]),(0,c.useEffect)((function(){d("disabled")}),[]);var m=function(){n(s,!0),d("inprogress"),setTimeout((function(){d("disabled")}),800)},p=function(e){"disabled"===o&&d("enabled"),e||d("disabled"),a(e)};return(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{id:"manual-input-title",className:"text-lg font-medium text-gray-900",children:"Manual input"}),(0,l.jsx)("textarea",{value:s,onChange:function(e){return p(e.target.value)},rows:10,className:"block w-full px-3 py-2 mt-3 border border-gray-300 rounded-md shadow-sm focus-visible:outline-blue-500 sm:text-sm",spellCheck:!1}),(0,l.jsxs)("div",{className:"flex flex-col mt-6 justify-stretch",children:[(0,l.jsx)(U,{text:"Save",callback:m,status:o,disabled:"disabled"===o,type:"button"}),(0,l.jsx)("span",{className:"block text-xs text-gray-500 text-center",children:"or press ctrl + s"})]})]})}var J=n(8229),X=n(9722),Y=n(169);function G(e){var t=e.hours,n=e.startTime,r=e.selectedDate,s=new Date,a=60*s.getHours()+s.getMinutes();return t<6&&r.toLocaleDateString()!==s.toLocaleDateString()||t<6&&a-I(n)>360?(0,l.jsx)("span",{"data-testid":"sixHoursBadge",className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"less than 6h"}):t<8&&r.toLocaleDateString()!==s.toLocaleDateString()||t<8&&a-I(n)>480?(0,l.jsx)("span",{"data-testid":"eightHoursBadge",className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"less than 8h"}):void 0}var K=n(8253),$=n(2873);function Q(e){var t=e.children,n=(0,c.useState)(!0),r=n[0],s=n[1],a=(0,c.useState)(!0),i=a[0],o=a[1];return(0,l.jsxs)("div",{className:"tooltip-wrapper",onClick:function(){s(!1),o(!1),setTimeout((function(){s(!0),setTimeout((function(){return o(!0)}),150)}),750)},children:[t,(0,l.jsxs)("p",{className:"tooltip \n        ".concat(r?"opacity-0":"opacity-90"," \n        ").concat(i?"invisible":"visible"),children:[(0,l.jsx)(O.Z,{className:"w-4 h-4"}),"Copied"]})]})}function ee(e){var t=e.activities,n=e.onEditActivity,r=e.selectedDate,s=(0,c.useMemo)((function(){return Z(t.filter((function(e){return!e.isBreak&&e.project})))}),[t]),a=(0,c.useMemo)((function(){return s.reduce((function(e,t){return e+(t.duration?t.duration:0)}),0)}),[s]),i=function(e){var t,n=e.target,r=n.textContent,s=n.getAttribute("data-column");if("duration"===s||"total"===s)if(r.includes("h"))t=r.slice(0,-1);else if(r.includes("m")){var a=r.slice(0,-1);t=Math.floor(a/60*100)/100}navigator.clipboard.writeText(t||r).then((function(){var e=document.createRange();e.selectNodeContents(n);var t=window.getSelection();t.removeAllRanges(),t.addRange(e),setTimeout((function(){t.removeAllRanges()}),100)})).catch((function(e){console.error("Clipboard write error:",e)}))},o=new Date;parseInt(o.getHours()+""+("0"+o.getMinutes()).substr(-2));return(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-300 table-fixed",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"w-24 pb-6 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 md:pl-0",children:"Interval"}),(0,l.jsx)("th",{scope:"col",className:"w-24 pb-6 px-3 text-left text-sm font-semibold text-gray-900",children:"Duration"}),(0,l.jsxs)("th",{scope:"col",className:"w-32 pb-6 px-3 text-left text-sm font-semibold text-gray-900 relative",children:[(0,l.jsx)("span",{className:"block absolute text-xs text-gray-500 top-[22px]",children:"activity"}),"Project"]}),(0,l.jsx)("th",{scope:"col",className:"pb-6 px-3 text-left text-sm font-semibold text-gray-900",children:"Description"}),(0,l.jsx)("th",{scope:"col",className:"relative w-8 pb-6 pl-3 pr-4 sm:pr-6 md:pr-0",children:(0,l.jsx)("span",{className:"sr-only",children:"Copy"})}),(0,l.jsx)("th",{scope:"col",className:"relative w-8 pb-6 pl-3 pr-4 sm:pr-6 md:pr-0",children:(0,l.jsx)("span",{className:"sr-only",children:"Edit"})})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[s.map((function(e){var s,a;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"py-4 pl-4 pr-3 text-sm text-gray-500 whitespace-nowrap sm:pl-6 md:pl-0",children:(0,l.jsxs)("span",{className:(0,M.Z)({"py-1 px-2 -mx-2 rounded-full font-medium bg-red-100 text-red-800":!e.isValid}),children:[e.from," - ",e.to]})}),(0,l.jsx)("td",{className:"px-3 py-4 text-sm font-medium text-gray-900 whitespace-nowrap ",children:(0,l.jsx)(Q,{children:(0,l.jsx)("p",{"data-column":"duration",onClick:i,children:C(e.duration)})})}),(0,l.jsxs)("td",{className:"flex flex-col px-3 py-4",children:[(0,l.jsx)(Q,{children:(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",onClick:i,children:e.project})}),e.activity&&(0,l.jsx)(Q,{children:(0,l.jsx)("p",{className:"block text-xs text-gray-500 font-semibold mt-1",onClick:i,children:e.activity})})]}),(0,l.jsx)("td",{className:"px-3 py-4 text-sm text-gray-500 ",children:(0,l.jsxs)(Q,{children:[(0,l.jsx)("p",{onClick:i,className:(0,M.Z)({"py-1 px-2 -mx-2 rounded-full font-medium bg-yellow-100 text-yellow-800":null===(s=e.mistakes)||void 0===s?void 0:s.includes("startsWith!")}),children:e.description}),(null===(a=e.mistakes)||void 0===a?void 0:a.includes("startsWith!"))&&(0,l.jsx)("span",{className:"block text-xs text-gray-500 mt-1",children:"Perhaps you wanted to report a break"})]})}),(0,l.jsx)("td",{className:"relative py-4 pl-3 pr-4 text-sm font-medium text-right whitespace-nowrap sm:pr-6 md:pr-0",children:(0,l.jsx)("a",{href:"#",className:"text-grey-300 hover:text-blue-600",onClick:function(){n((0,Y.Z)((0,X.Z)({},e),{id:null,from:t[t.length-2].to,to:L(r)?A():"",duration:null}))},children:(0,l.jsx)(K.Z,{className:"w-[18px] h-[18px] text-gray-600 hover:text-gray-900"})})}),(0,l.jsx)("td",{className:"relative py-4 pl-3 pr-4 text-sm font-medium text-right whitespace-nowrap sm:pr-6 md:pr-0",children:(0,l.jsx)("a",{href:"#",className:"text-blue-600 hover:text-blue-900",onClick:function(){return n(e)},children:(0,l.jsx)($.Z,{className:"w-[18px] h-[18px] text-gray-600 hover:text-gray-900"})})})]},e.id)})),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"py-4 pl-4 pr-3 text-sm text-gray-500 whitespace-nowrap sm:pl-6 md:pl-0",children:(0,l.jsx)("p",{children:"Total"})}),(0,l.jsx)("td",{className:"px-3 py-4 text-sm font-medium text-gray-900 whitespace-nowrap",onClick:i,children:(0,l.jsx)(Q,{children:(0,l.jsx)("p",{"data-column":"total",children:C(a)})})}),(0,l.jsx)("td",{className:"px-3 py-4 text-sm font-medium text-gray-900 whitespace-nowrap",colSpan:4,children:(0,l.jsx)(G,{hours:a/36e5,startTime:s[0].from,selectedDate:r})})]})]})]})}var te=n(2033);function ne(e){var t=e.onEditActivity,n=e.activities,r=e.selectedDate,s=function(e){"Space"===e.code&&e.ctrlKey&&t("new")};return(0,c.useEffect)((function(){return document.addEventListener("keydown",s),function(){document.removeEventListener("keydown",s)}}),[]),(null===n||void 0===n?void 0:n.length)?(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"px-4 py-5 sm:px-6",children:(0,l.jsx)(ee,{onEditActivity:t,activities:n,selectedDate:r})}),(0,l.jsx)("div",{children:(0,l.jsxs)("button",{className:"block w-full px-4 py-4 text-sm font-medium text-center text-blue-500 bg-blue-200 hover:bg-blue-300 sm:rounded-b-lg",onClick:function(){return t("new")},children:["Track more time",(0,l.jsx)("span",{className:"block text-blue-500 text-xs",children:"click or press ctrl + space"})]})})]}):n?(0,l.jsx)(re,{onEditActivity:t}):(0,l.jsx)(se,{})}function re(e){var t=e.onEditActivity;return(0,l.jsxs)("div",{className:"py-6 text-center",children:[(0,l.jsx)(J.Z,{className:"w-12 h-12 mx-auto text-gray-400","aria-hidden":"true"}),(0,l.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tracked time"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by tracking some activity"}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("button",{onClick:function(){return t("new")},type:"button",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,l.jsx)(te.Z,{className:"w-5 h-5 mr-2 -ml-1","aria-hidden":"true"}),"New activity"]}),(0,l.jsx)("span",{className:"block text-gray-500 text-xs",children:"or press ctrl + space"})]})]})}function se(){return(0,l.jsxs)("div",{className:"py-16 text-center bg-white shadow sm:rounded-lg lg:col-start-1 lg:col-span-3",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-12 h-12 mx-auto text-red-500",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),(0,l.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Parsing Error"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"There is something wrong with the file. Try to correct the error in the report in the Manual Input field."})]})}const ae=function(e){var t=e.setFolder;return(0,l.jsxs)("div",{className:"py-16 text-center bg-white shadow sm:rounded-lg lg:col-start-1 lg:col-span-3",children:[(0,l.jsx)("svg",{className:"w-12 h-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),(0,l.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Select a Folder"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"To get started, select a folder to save the reports."}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsxs)("button",{type:"button",onClick:function(){o.ipcRenderer.invoke("app:select-folder").then((function(e){e&&t(e)}))},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,l.jsx)(te.Z,{className:"w-5 h-5 mr-2 -ml-1","aria-hidden":"true"}),"Select Folder"]})})]})};var ie=n(92);function le(){var e=(0,c.useState)(!1),t=e[0],n=e[1],r=(0,c.useState)(!1),s=r[0],a=r[1],i=(0,c.useState)(""),d=i[0],u=i[1];(0,c.useEffect)((function(){o.ipcRenderer.send("start-update-watcher"),o.ipcRenderer.on("update-available",(function(e,t,r){n(t),u(r.version)})),o.ipcRenderer.on("downloaded",(function(e,t,n){a(t),u(n.version)}))}),[]);return(0,l.jsx)("div",{className:"flex justify-center pt-2",children:(0,l.jsxs)("div",{className:"flex gap-2 items-center flex-shrink-0 px-2 lg:px-0",children:[t&&!s&&(0,l.jsxs)("span",{className:"flex gap-2 items-center rounded-lg px-3 py-2 bg-blue-300 text-blue-800",children:[(0,l.jsx)(ie.Z,{className:"w-6 h-6 fill-blue-400 stroke-white"}),"The version ",d," is loading"]}),s&&(0,l.jsxs)("span",{className:"flex gap-2 items-center rounded-lg px-3 py-2 text-sm bg-green-300 text-green-800",children:[(0,l.jsx)(O.Z,{className:"w-6 h-6 fill-green-800"}),(0,l.jsxs)("p",{className:"whitespace-normal",children:["New version ",d," is downloaded. Turn off the app, or click the Install button"]}),(0,l.jsx)("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:function(){o.ipcRenderer.send("install")},children:"Install"})]})]})})}var oe={getItem:function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,o.ipcRenderer.invoke("storage:get",e)];case 1:return[2,t.sent()||null]}}))}));return function(t){return e.apply(this,arguments)}}(),setItem:function(){var e=(0,r.Z)((function(e,t){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,o.ipcRenderer.invoke("storage:set",e,t)];case 1:return n.sent(),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),removeItem:function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,o.ipcRenderer.invoke("storage:delete",e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}()},ce=(0,b.Ue)()((0,y.mW)((0,y.tJ)((function(e){return{update:{age:"old",description:null},setUpdate:function(t){return e({update:{age:t.age,description:t.description}})}}}),{name:"update-storage",storage:(0,y.FL)((function(){return oe}))}))),de={getItem:function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,o.ipcRenderer.invoke("storage:get",e)];case 1:return[2,t.sent()||null]}}))}));return function(t){return e.apply(this,arguments)}}(),setItem:function(){var e=(0,r.Z)((function(e,t){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,o.ipcRenderer.invoke("storage:set",e,t)];case 1:return n.sent(),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),removeItem:function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,o.ipcRenderer.invoke("storage:delete",e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}()},ue=(0,b.Ue)()((0,y.mW)((0,y.tJ)((function(e){return{isBeta:!1,setIsBeta:function(t){return e({isBeta:t})}}}),{name:"beta-storage",storage:(0,y.FL)((function(){return de}))}))),me=n(1147);function pe(e){return(0,l.jsx)("div",{className:"lg:absolute mt-6 w-full",children:(0,l.jsxs)("div",{className:(0,M.Z)("h-16 px-4 py-5 bg-white shadow overflow-hidden transition-all ease-linear duration-300 sm:rounded-lg sm:px-6",{"h-80 overflow-y-auto ":e.isOpen}),children:[(0,l.jsxs)("div",{className:"flex justify-between cursor-pointer",onClick:e.toggleFunction,children:[(0,l.jsx)("h2",{id:"manual-input-title",className:"text-lg font-medium text-gray-900",children:e.title}),(0,l.jsx)("button",{className:(0,M.Z)("transform transition-transform ease-linear duration-300",{"rotate-180":e.isOpen}),children:(0,l.jsx)(me.Z,{className:"w-6 h-7","aria-hidden":"true"})})]}),e.children]})})}function xe(){var e=(0,c.useState)(),t=e[0],n=e[1],r=(0,c.useState)(null===o.app||void 0===o.app?void 0:o.app.getVersion()),a=r[0],i=r[1],u=(0,c.useState)(!1),m=u[0],p=u[1],x=(0,s.Z)(ce((function(e){return[e.update,e.setUpdate]}),d.X),2),h=x[0],f=x[1],v=(0,s.Z)(ue((function(e){return[e.isBeta,e.setIsBeta]}),d.X),2),g=v[0],b=v[1],y=(0,c.useState)("new"===(null===h||void 0===h?void 0:h.age)),j=y[0],w=y[1];(0,c.useEffect)((function(){o.ipcRenderer.send("beta-channel",g)}),[g]),o.ipcRenderer.on("update-available",(function(e,t,n){p(t)})),o.ipcRenderer.on("downloaded",(function(e,t,r){n(r),w(!0),f({age:"new",description:null===r||void 0===r?void 0:r.releaseNotes})})),o.ipcRenderer.on("current-version",(function(e,t){i(t)}));return(0,l.jsxs)(pe,{toggleFunction:function(){j?(w(!1),f({age:"old",description:null===h||void 0===h?void 0:h.description})):(w(!0),f({age:"new",description:null===h||void 0===h?void 0:h.description}))},isOpen:j,title:"What's new?",children:[(0,l.jsxs)("p",{className:"text-xs text-gray-700 font-semibold",children:["Current version ",a," ",!m&&"(latest)"]}),(0,l.jsx)("div",{className:"relative flex items-start my-4",children:(0,l.jsxs)("div",{className:"relative flex items-start my-4",children:[(0,l.jsx)("div",{className:"flex items-center h-5",children:(0,l.jsx)("input",{id:"comments","aria-describedby":"comments-description",name:"comments",type:"checkbox",defaultChecked:g,onChange:function(){return b(!g)},className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),(0,l.jsxs)("div",{className:"ml-2 text-sm",children:[(0,l.jsx)("label",{htmlFor:"comments",className:"font-medium text-gray-700",children:"Download beta version"}),(0,l.jsx)("p",{id:"comments-description",className:"text-gray-500",children:"You need to restart the application (or reopen from the tray)"})]})]})}),(0,l.jsxs)("h2",{className:"font-bold",children:["In ",(null===t||void 0===t?void 0:t.version)?null===t||void 0===t?void 0:t.version:a," version"]}),(null===h||void 0===h?void 0:h.description)?(0,l.jsx)("div",{className:"flex flex-col gap-2 mb-3",dangerouslySetInnerHTML:{__html:null===h||void 0===h?void 0:h.description}}):(0,l.jsx)("div",{className:"flex flex-col gap-2 mb-3",children:"Here you will receive notifications about the app's content updates after downloading the new version."})]})}var he=n(3784),fe=n(2866),ve=n(1499),ge=["January","February","March","April","May","June","July","August","September","October","November","December"];function be(e){var t=e.reportsFolder,n=e.selectedDate,s=e.setSelectedDate,a=(0,c.useState)(new Date),d=a[0],u=a[1],m=(0,c.useState)([]),x=m[0],h=m[1],f=(0,c.useState)([]),v=f[0],g=f[1],b=(0,c.useRef)(null),y=ge[d.getMonth()],j=d.getFullYear(),w=(0,c.useMemo)((function(){return C(function(e,t){var n=t.getFullYear()+(t.getMonth()+1).toString().padStart(2,"0");return e.reduce((function(e,t){return t.date.includes(n)&&(e+=t.workDurationMs),e}),0)}(v,d))}),[v,d]);(0,c.useEffect)((function(){return(0,r.Z)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,o.ipcRenderer.invoke("app:find-month-projects",t,d)];case 1:return h.apply(void 0,[e.sent()]),[2]}}))}))(),o.ipcRenderer.send("start-folder-watcher",t,d),o.ipcRenderer.on("any-file-changed",(function(e,n){(0,r.Z)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,o.ipcRenderer.invoke("app:find-month-projects",t,d)];case 1:return h.apply(void 0,[e.sent()]),[2]}}))}))()})),function(){o.ipcRenderer.removeAllListeners("any-file-changed")}}),[d,t]),(0,c.useEffect)((function(){var e=x.map((function(e){var t=e.reportDate,n=Z((k(e.data)[0]||[]).filter((function(e){return!e.isBreak}))),r=n.reduce((function(e,t){return e+(t.duration||0)}),0);return{date:t,week:T(t),workDurationMs:r,isValid:n.every((function(e){return!0===e.isValid}))}}));g(e)}),[x]);var N=function(){return b.current.getApi()};return(0,l.jsxs)("div",{className:"wrapper bg-white p-4 rounded-lg shadow",children:[(0,l.jsxs)("div",{className:"calendar-header h-10 flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"".concat(y," ").concat(j)}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:["Total: ",w]})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[d.getMonth()!==(new Date).getMonth()&&(0,l.jsx)(U,{text:"Go to current month",callback:function(){N().today(),u(new Date)},type:"button"}),(0,l.jsx)(p,{prevCallback:function(){N().prev(),u((function(e){return new Date(e.setMonth(e.getMonth()-1,1))}))},nextCallback:function(){N().next(),u((function(e){return new Date(e.setMonth(e.getMonth()+1,1))}))}})]})]}),(0,l.jsx)(he.Z,{ref:b,plugins:[fe.Z,ve.ZP],headerToolbar:!1,initialView:"dayGridMonth",firstDay:1,events:v,eventContent:ye,dateClick:function(e){e.date.setHours(1),s(e.date)},dayCellClassNames:function(e){return function(e,t){var n=new Date(e),r=new Date(t);return n.setHours(0,0,0,0)===r.setHours(0,0,0,0)}(e.date,n)?"fc-custom-today-date":""},weekNumbers:!0,weekNumberContent:function(e){var t=C(v.reduce((function(t,n){return n.week===e.num&&(t+=n.workDurationMs),t}),0));return(0,l.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,l.jsxs)("span",{children:["week ",e.num]}),(0,l.jsx)("span",{className:"self-start",children:t})]})},height:"auto"})]})}function ye(e){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{children:["Logged: ",C(e.event.extendedProps.workDurationMs)]}),!1===e.event.extendedProps.isValid&&(0,l.jsx)(ie.Z,{className:"w-5 h-5 absolute fill-red-500 -top-[290%] left-[60%]"})]})}function je(){var e=(0,s.Z)(w((function(e){return[e.reportsFolder,e.setReportsFolder]}),d.X),2),t=e[0],n=e[1],u=(0,c.useState)(new Date),m=u[0],p=u[1],x=(0,c.useState)(""),f=x[0],v=x[1],g=(0,c.useState)([]),b=g[0],y=g[1],j=(0,c.useState)(!1),S=j[0],C=j[1],D=(0,c.useState)(null),Z=D[0],M=D[1],E=(0,c.useState)({}),F=E[0],R=E[1],_=(0,c.useState)({}),L=_[0],T=_[1],A=(0,c.useState)([]),B=A[0],O=A[1],P=(0,c.useCallback)((function(){var e=(new Date).toLocaleDateString(),t=localStorage.getItem("lastUsingDate");t&&e!==t&&(localStorage.setItem("lastUsingDate",e),window.location.reload()),localStorage.setItem("lastUsingDate",e)}),[]);(0,c.useEffect)((function(){return document.addEventListener("visibilitychange",P),function(){document.removeEventListener("visibilitychange",P)}}),[]),(0,c.useEffect)((function(){(0,r.Z)((function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,o.ipcRenderer.invoke("app:read-day-report",t,m)];case 1:return e=r.sent(),v(e||""),[4,o.ipcRenderer.invoke("app:find-latest-projects",t,m)];case 2:return n=r.sent(),R(n.sortedProjAndAct||{}),T(n.descriptionsSet||{}),[2]}}))}))(),o.ipcRenderer.send("start-file-watcher",t,m),o.ipcRenderer.on("file-changed",(function(e,t){f!=t&&v(t||"")})),o.ipcRenderer.on("errorMes",(function(e,t){console.log("event ",e),console.log("data ",t)}))}),[m,t]),(0,c.useEffect)((function(){if(f){O(k(f));var e=k(f)[0];y(e)}else y([])}),[f]),(0,c.useEffect)((function(){if(S){var e=function(e){var t="",n=!0,r=!1,a=void 0;try{for(var i,l=e.entries()[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var o=(0,s.Z)(i.value,2),c=o[0],d=o[1],u=[d.from];u.push(d.project),d.activity&&u.push(d.activity),d.description&&u.push(d.description),d.activity&&!d.description&&u.push(""),t+="".concat(u.join(" - "),"\n");var m=e[c+1];m&&m.from!==d.to&&d.to&&(t+="".concat(d.to," - !\n")),m||d.to&&(t+="".concat(d.to," - \n"))}}catch(p){r=!0,a=p}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}return t}(b)+(!B[1]||B[1].startsWith("undefined")?"":B[1]);H(e),C(!1)}}),[b]);var H=function(e){o.ipcRenderer.invoke("app:write-day-report",t,m,e),v(e)};return(0,l.jsxs)("div",{className:"min-h-full",children:[(0,l.jsx)(N,{}),(0,l.jsx)(le,{}),(0,l.jsx)("main",{className:"py-10",children:(0,l.jsxs)("div",{className:"grid max-w-3xl grid-cols-1 gap-6 mx-auto sm:px-6 lg:max-w-[1400px] lg:grid-cols-[31%_31%_auto]",children:[t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"space-y-6 lg:col-start-1 lg:col-span-2 flex flex-col",children:[(0,l.jsx)("section",{children:(0,l.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,l.jsx)(h,{selectedDate:m,setSelectedDate:p})})}),(0,l.jsx)("section",{className:"flex-grow",children:(0,l.jsx)("div",{className:"bg-white shadow sm:rounded-lg h-full",children:(0,l.jsx)(ne,{activities:b,onEditActivity:M,selectedDate:m})})})]}),(0,l.jsxs)("section",{"aria-labelledby":"manual-input-title",className:"lg:col-start-3 lg:col-span-1 relative",children:[(0,l.jsx)("div",{className:"px-4 py-5 bg-white shadow sm:rounded-lg sm:px-6",children:(0,l.jsx)(q,{onSave:function(e,t){v(e),C(t)},selectedDateReport:f})}),(0,l.jsx)(xe,{})]})]}):(0,l.jsx)(ae,{setFolder:n}),(0,l.jsx)("section",{className:"lg:col-span-2",children:(0,l.jsx)(be,{reportsFolder:t,selectedDate:m,setSelectedDate:p})})]})}),(0,l.jsx)(z,{activities:b,isOpen:null!==Z,editedActivity:Z,latestProjAndAct:F,latestProjAndDesc:L,close:function(){return M(null)},submitActivity:function(e){var t=!1,n=!1,r=[],s=I(e.from),i=I(e.to),l=b.findIndex((function(t){return t.id===e.id}));b.length||(e.id=1,r.push(e),y(r)),l>=0&&(y((function(t){var n=t[l];return Object.keys(e).every((function(t){return n[t]===e[t]}))?(t.forEach((function(e,t){return e.id=t+1,e.isBreak?e.to="":e.to=e.to})),t):(t[l]=e,t[l+1].isBreak?t.splice(l+1,1):i>I(t[l+1].from)&&(t[l+1].from=t[l].to),(0,a.Z)(t))})),t=!0);for(var o=0;o<b.length;o++){var c=I(b[o].from);if(s<c&&!n&&(r.push(e),n=!0),!o&&s<c){var d;(d=r).push.apply(d,(0,a.Z)(b));break}s!==c?r.push(b[o]):(r.push(e),n=!0)}r.forEach((function(e,t){return e.id=t+1,e.isBreak?e.to="":e.to=e.to})),r.length!==b.length||t||(!n&&r.push(e),y(r.filter((function(e){return e.duration})))),n&&!t&&y(r),C(!0)},selectedDate:m})]})}}},e=>{e.O(0,[516,638,774,888,179],(()=>{return t=9536,e(e.s=t);var t}));var t=e.O();_N_E=t}]);